---
title: "Nearshore Network Analysis"
author: "Nick Framsted"
date: "1/5/2021"
output: pdf_document
---

```{r setup, include=FALSE}
library(ggplot2)
library(tidyverse)
library(lubridate)
library(ggpubr)
# changing working directory from /scripts to /tahoe_lab_inc_analysis
knitr::opts_knit$set(root.dir = '..')
```

```{r}
# importing dataset for tahoe city (closest site to the pineland site)
dat_TC <- read_csv("C:/Users/ntframst/Documents/Tahoe_nearshore_network_data/TC.txt")
str(dat_TC)
```

### plotting temperature (probeT) for TC site
```{r}
# filtering out period of NAs in ProbeT column
dat_TC %>%
  filter(TimeLocal < "2020-10-01 00:00:00") %>%
  ggplot(aes(x = TimeLocal, y = ProbeT)) +
  geom_line()

# violin plot of daily temperatures
dat_TC %>%
  mutate(day = date(TimeLocal)) %>%
  filter(!is.na(ProbeT)) %>%
  ggplot(aes(x = day, y = ProbeT, group = day)) +
  geom_violin() +
  theme_bw(base_size = 20)

# looking at daily scales of temp variability
daily_T <- dat_TC %>%
  mutate(day = date(TimeLocal)) %>%
  group_by(day) %>%
  summarize(avg_T = mean(ProbeT), min_T = min(ProbeT), max_T = max(ProbeT)) %>%
  mutate(range_T = max_T - min_T)
daily_T


# adding in season column to data, grouping rows by season to calculate seasonal average temp standard deviation
seasonal_T <- daily_T %>%
  mutate(season = ifelse(day >= "2019-12-31" & day < "2020-03-01", "W", ifelse(day >= "2020-03-01" & day < "2020-06-01", "Spr", ifelse(day >= "2020-06-01" & day < "2020-09-01", "Sum", "F")))) %>%
  filter(!is.na(range_T)) %>%
  group_by(season) %>%
  summarize(avg_daily_range = mean(range_T), max_daily_range = max(range_T))
seasonal_T
```

