---
title: "Sugarpint Incubation 12/01/2020"
author: "Nick Framsted"
date: "12/8/2020"
output: pdf_document
---

```{r setup, include=FALSE}
library(ggplot2)
library(tidyverse)
library(lubridate)
library(ggpubr)
# changing working directory from /scripts to /tahoe_lab_inc_analysis
knitr::opts_knit$set(root.dir = '..')
```

# importing and cleaning up data
```{r}
dat <- read_csv("data/201201_sugarpt_lab_inc_R.csv", skip = 1)
str(dat)
#View(dat)

# filtering out rows with error codes, and adding in chamber numbers based on sensor column
dat_2 <- dat %>%
  filter(is.na(error)) %>%
  mutate(chamber = ifelse(sensor == "Batch 3 (PSt3)", 1, ifelse(sensor == "Batch 3_1 (PSt3)", 2, ifelse(sensor == "Batch 3_2 (PSt3)", 3, 4))))
head(dat_2)

# selecting only columns I need
dat_subset <- dat_2 %>%
  select(date, delta_T_min, oxygen, temp, chamber)

# formatting date times column to posixct
dat_subset$date_time_PST <- dmy_hms(dat_subset$date, tz = "America/Los_Angeles")
head(dat_subset)

```

# plotting O2 signals
```{r}
# plotting only data points with no error code
dat_subset %>%
  ggplot(aes(x = delta_T_min, y = oxygen)) +
  geom_point() +
  facet_wrap(~chamber)

# plot of all data points (including rows with errors)
#first need to add chamber column to dat dataframe
dat %>%
  mutate(chamber = ifelse(sensor == "Batch 3 (PSt3)", 1, ifelse(sensor == "Batch 3_1 (PSt3)", 2, ifelse(sensor == "Batch 3_2 (PSt3)", 3, 4)))) %>%
  filter(oxygen < 10.5 & oxygen > 0) %>% #filtering out outlier datapoints
  ggplot(aes(x = delta_T_min, y = oxygen)) +
  geom_point(aes(color = error)) +
  facet_wrap(~chamber)

# lots of crazy data points in the data with errors included
```
# calculating metabolic reate 
```{r}

```

